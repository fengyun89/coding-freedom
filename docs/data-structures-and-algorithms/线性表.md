# 线性表(List)

线性表是数据元素的有序序列。

除了第一个元素，每个元素有且只有一个前驱；除了最后一个元素，每个元素有且只有一个后继。

## 线性表的抽象数据类型

```
ADT List {
    数据对象：
        D = { ei | ei ∈ ElementSet, i = 1, 2, ..., n, n >= 0 }
    数据关系：
        R = { <ei-1, ei> | ei-1, ei ∈ D, i = 2, 3, ..., n }
    基本操作：
        unshift(element) 向线性表头部添加元素
        push(element) 向线性表尾部添加元素
        insert(position, element) 向线性表指定位置添加元素
        shift() 删除线性表头部的元素
        pop() 删除线性表尾部的元素
        removeAt(position) 删除线性表中指定位置的元素
        remove(element) 删除线性表中指定元素
        getFirst() 获取线性表头部的元素
        getLast() 获取线性表尾部的元素
        getElementAt(position) 获取线性表中指定位置的元素
        indexOf(element) 获取线性表中指定元素的位置
        clear() 清空线性表
        isEmpty() 判断线性表是否为空
        size() 获取线性表中元素的个数
        print() 打印线性表中的元素
}
```

## 线性表的顺序存储实现 —— 顺序表(Sequential List)

内存连续的数组是一种顺序表，但 JavaScript 的数组实际是个对象，它的元素不是内存连续的。

但，还是只能假装使用数组来实现顺序表

```js
export default class SequentialList {
    #data = [];

    // 向线性表头部添加元素
    unshift(element) {
        this.#data.unshift(element);
    }

    // 向线性表尾部添加元素
    push(element) {
        this.#data.push(element);
    }

    // 向线性表指定位置添加元素
    insert(position, element) {
        this.#data.splice(position, 0, element);
    }

    // 删除线性表头部的元素
    shift() {
        return this.#data.shift();
    }

    // 删除线性表尾部的元素
    pop() {
        return this.#data.pop();
    }

    // 删除线性表中指定位置的元素
    removeAt(position) {
        return this.#data.splice(position, 1);
    }

    // 删除线性表中指定元素
    remove(element) {
        const position = this.indexOf(element);
        return this.removeAt(position);
    }

    // 获取线性表头部的元素
    getFirst() {
        return this.#data[0];
    }

    // 获取线性表尾部的元素
    getLast() {
        return this.#data[this.#data.length - 1];
    }

    // 获取线性表中指定位置的元素
    getElementAt(position) {
        return this.#data[position];
    }

    // 获取线性表中指定元素的位置
    indexOf(element) {
        return this.#data.indexOf(element);
    }

    // 清空线性表
    clear() {
        this.#data = [];
    }

    // 判断线性表是否为空
    isEmpty() {
        return this.size() === 0;
    }

    // 获取线性表中元素的个数
    size() {
        return this.#data.length;
    }

    // 打印线性表中的元素
    print() {
        console.log(this.#data.toString());
    }
}
```

## 线性表的链式存储实现 —— 链表(Linked List)

链表中的数据元素称为`结点`，结点中包含`数据域`和`指针域`。

指针域指向下一个结点，最后一个结点的指针域指向`空`。

链表的第一个结点称为`头结点`，头结点的指针域指向第一个结点。

### 单向链表(Singly Linked List)

```js
export default class SinglyLinkedList {
    #head = null;

    // 向线性表头部添加元素
    unshift(element) {
        this.insert(0, element)
    }

    // 向线性表尾部添加元素
    push(element) {
        this.insert(this.size(), element)
    }

    // 向线性表指定位置添加元素
    insert(position, element) {
        if (position > this.size()) return;
        const newNode = {
            data: element,
            next: null,
        };
        if (position === 0) {
            newNode.next = this.#head;
            this.#head = newNode;
        } else {
            const previous = this.getElementAt(position - 1);
            newNode.next = previous.next;
            previous.next = newNode;
        }
    }

    // 删除线性表头部的元素
    shift() {
        return this.removeAt(0);
    }

    // 删除线性表尾部的元素
    pop() {
        return this.removeAt(this.size() - 1);
    }

    // 删除线性表中指定位置的元素
    removeAt(position) {
        if (position >= this.size()) return;
        const deleteNode = this.getElementAt(position);
        if (deleteNode === this.#head) {
            this.#head = deleteNode.next;
        } else {
            const previous = this.getElementAt(position - 1);
            previous.next = deleteNode.next;
        }
        return deleteNode.data;
    }

    // 删除线性表中指定元素
    remove(element) {
        const position = this.indexOf(element);
        return this.removeAt(position);
    }

    // 获取线性表头部的元素
    getFirst() {
        return this.getElementAt(0).data;
    }

    // 获取线性表尾部的元素
    getLast() {
        this.getElementAt(this.size() - 1).data;
    }

    // 获取线性表中指定位置的元素
    getElementAt(position) {
        if (position >= this.size()) return;
        let current = this.#head;
        let index = 0;
        while (index < position) {
            current = current.next;
            index++;
        }
        return current;
    }

    // 获取线性表中指定元素的位置
    indexOf(element) {
        let current = this.#head;
        let index = 0;
        while (current) {
            if (current.data === element) {
                return index;
            }
            index++;
            current = current.next;
        }
        return -1;
    }

    // 清空线性表
    clear() {
        this.#head = null;
    }

    // 判断线性表是否为空
    isEmpty() {
        return this.size() === 0;
    }

    // 获取线性表中元素的个数
    size() {
        let count = 0;
        let current = this.#head;
        while (current) {
            count++;
            current = current.next;
        }
        return count;
    }

    // 打印线性表中的元素
    print() {
        let current = this.#head;
        let str = '';
        while (current) {
            str += `${current.data} `;
            current = current.next;
        }
        console.log(str);
    }
}
```

### 双向链表(Doubly Linked List)

```js
export default class DoublyLinkedList {
    #head = null;

    // 向线性表头部添加元素
    unshift(element) {
        this.insert(0, element)
    }

    // 向线性表尾部添加元素
    push(element) {
        this.insert(this.size(), element)
    }

    // 向线性表指定位置添加元素
    insert(position, element) {
        if (position > this.size()) return;
        const newNode = {
            data: element,
            next: null,
            prev: null,
        };
        if (position === 0) {
            newNode.next = this.#head;
            if (this.#head) {
                this.#head.prev = newNode;
            }
            this.#head = newNode;
        } else {
            const previous = this.getElementAt(position - 1);
            newNode.next = previous.next;
            if (previous.next) {
                previous.next.prev = newNode;
            }
            previous.next = newNode;
            newNode.prev = previous;
        }
    }

    // 删除线性表头部的元素
    shift() {
        return this.removeAt(0);
    }

    // 删除线性表尾部的元素
    pop() {
        return this.removeAt(this.size() - 1);
    }

    // 删除线性表中指定位置的元素
    removeAt(position) {
        if (position >= this.size()) return;
        const deleteNode = this.getElementAt(position);
        if (deleteNode === this.#head) {
            this.#head = deleteNode.next;
            if (this.#head) {
                this.#head.prev = null;
            }
        } else {
            deleteNode.prev.next = deleteNode.next;
            if (deleteNode.next) {
                deleteNode.next.prev = deleteNode.prev;
            }
        }
        return deleteNode.data;
    }

    // 删除线性表中指定元素
    remove(element) {
        const position = this.indexOf(element);
        return this.removeAt(position);
    }

    // 获取线性表头部的元素
    getFirst() {
        return this.getElementAt(0).data;
    }

    // 获取线性表尾部的元素
    getLast() {
        this.getElementAt(this.size() - 1).data;
    }

    // 获取线性表中指定位置的元素
    getElementAt(position) {
        if (position >= this.size()) return;
        let current = this.#head;
        let index = 0;
        while (index < position) {
            current = current.next;
            index++;
        }
        return current;
    }

    // 获取线性表中指定元素的位置
    indexOf(element) {
        let current = this.#head;
        let index = 0;
        while (current) {
            if (current.data === element) {
                return index;
            }
            index++;
            current = current.next;
        }
        return -1;
    }

    // 清空线性表
    clear() {
        this.#head = null;
    }

    // 判断线性表是否为空
    isEmpty() {
        return this.size() === 0;
    }

    // 获取线性表中元素的个数
    size() {
        let count = 0;
        let current = this.#head;
        while (current) {
            count++;
            current = current.next;
        }
        return count;
    }

    // 打印线性表中的元素
    print() {
        let current = this.#head;
        let str = '';
        while (current) {
            str += `${current.data} `;
            current = current.next;
        }
        console.log(str);
    }
}
```

### 循环链表(Circular Linked List)

#### 单向循环链表(Singly Circular Linked List)

尾节点的 next 指向头节点

#### 双向循环链表(Doubly Circular Linked List)

尾节点的 next 指向头节点，头节点的 prev 指向尾节点